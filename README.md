# bnd_test

# Детекция людей на видео с использованием YOLOv8

## Описание

Проект реализует детекцию людей на видео с помощью предобученной модели YOLOv8 от Ultralytics. Результатом работы является видео с аннотированными рамками вокруг обнаруженных людей.

## Установка

Рекомендуется использовать виртуальное окружение Python.

Windows
python -m venv venv
venv\Scripts\activate

Linux/MacOS
python3 -m venv venv
source venv/bin/activate

pip install -r requirements.txt

## Использование

Запустите скрипт, указав путь к входному и выходному видео, а также параметры модели и порог уверенности в коде функции `main` в `person_detection.py`.

Пример запуска:

python person_detection.py

## Настройки

Параметры задаются напрямую в `main`:

- `input_video_path` — путь к исходному видео файлу
- `output_video_path` — путь для сохранения результата
- `model_name` — вариант модели YOLOv8 (`yolov8n.pt`, `yolov8s.pt`, `yolov8m.pt`, `yolov8l.pt`, `yolov8x.pt`)
- `confidence_threshold` — минимальный порог уверенности для отображения детекций

## Зависимости

ultralytics>=8.0.0
torch>=2.0.0
torchvision>=0.15.0
opencv-python-headless>=4.8.0
numpy>=1.24.0
tqdm>=4.65.0

## Особенности

- Автоматическая загрузка предобученных весов
- Фильтрация детекций только для класса "person"
- Возможность выбора варианта модели в зависимости от баланса между скоростью и точностью
- Поддержка GPU для ускорения инференса


## Выбор модели

YOLOv8 выбрана как оптимальное решение для данной задачи благодаря:

- Высокая скорость инференса (30-60 FPS для nano/small версий)
- Хороший баланс точности и производительности (mAP ~50-55% для класса person на COCO)
- Простота использования через Ultralytics API
- Предобученные веса на COCO dataset с классом person
- Масштабируемость (5 вариантов моделей от nano до extra-large)

## Анализ качества распознавания

### Сильные стороны

- Хорошая детекция людей в различных позах и ракурсах
- Устойчивость к частичным перекрытиям
- Стабильная работа при различном освещении
- Эффективная детекция объектов разных масштабов (близко/далеко от камеры)
- Предобученная на большом и разнообразном датасете COCO

### Ограничения текущей реализации

- Возможны ложные срабатывания при сильных окклюзиях в толпах
- Пропуск мелких объектов на очень дальнем плане
- Отсутствие отслеживания объектов между кадрами (каждый кадр обрабатывается независимо)
- Возможность дублирования детекций для одного человека при частичном перекрытии

## Рекомендации по улучшению

### 1. Применение object tracking

Добавить алгоритмы отслеживания (DeepSORT, ByteTrack) для:

- Присвоения уникальных ID каждому человеку
- Устранения дубликатов детекций между кадрами
- Сглаживания координат bounding boxes
- Возможности подсчета количества людей

### 2. Оптимизация гиперпараметров

- Экспериментировать с `confidence_threshold` (0.3-0.6 в зависимости от качества видео)
- Настройка IoU threshold для Non-Maximum Suppression (NMS)
- Тестирование на различных разрешениях входного видео

### 3. Дообучение на специфичных данных

- Сбор датасета, характерного для целевого сценария (например, толпы определённого типа)
- Fine-tuning модели на собственных данных
- Использование данных аугментации для расширения датасета

### 4 Ансамблирование моделей

- Комбинирование YOLOv8 с другими детекторами (Faster R-CNN, RF-DETR)
- Weighted boxes fusion для объединения предсказаний
- Увеличение точности за счет согласованности нескольких моделей

## Автор

Крикунов Дмитрий
